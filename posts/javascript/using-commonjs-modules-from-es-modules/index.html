<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Schemescape: Can you use CommonJS modules from within an ES module?</title>
        <meta name="description" content="Is it possible to import a CommonJS module from within an ES module? Only in Node." />
        <meta name="keywords" content="commonjs,es-modules,node" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <link rel="stylesheet" href="../../../css/style.css" />
        <link rel="alternate" type="application/rss+xml" href="../../../feed.xml" />
    </head>
    <body>
        <main>
            <header>
                <h1><a href="../../../">Schemescape</a></h1>
                <p>Development log of a life-long coder</p>
            </header>
<article>
    <header>
        <h1><a href=".">Can you use CommonJS modules from within an ES module?</a></h1>
        <p><time datetime="2021-09-29">September 29, 2021</time></p>
    </header>
<h1 id="question">Question</h1>
<p>Is it possible to import a CommonJS module from within an ES module (using <code>import</code> syntax)?</p>
<p>I thought a quick web search would answer this question, but instead most of the resources I found were about trying to <code>require()</code> ES modules (which you definitely can&#39;t do).</p>
<h1 id="background">Background</h1>
<p>JavaScript didn&#39;t originally have a module system, so various groups have created their own systems, e.g. <a href="http://www.commonjs.org/">CommonJS</a>, <a href="https://github.com/amdjs/amdjs-api">Asynchronous Module Definition (AMD)</a>, and the ironically named <a href="https://github.com/umdjs/umd">Universal Module Definition (UMD)</a>.</p>
<p>Predictably, there&#39;s now an official <a href="https://tc39.es/ecma262/#sec-modules">ECMAScript Modules</a> format that <del>everyone uses</del> <del>everyone should use</del> some people have started using (<del>because it&#39;s incompatible and they have no choice</del> because it&#39;s part of the official JavaScript/ECMAScript specification). And I won&#39;t even dig into the ES module file extension dumpster fire.</p>
<p>Anyway, back to the question: can I import a CommonJS module into my ES module?</p>
<h1 id="lets-just-try-it">Let&#39;s just try it...</h1>
<p>Here&#39;s a CommonJS module:</p>
<pre><code>exports.test = &quot;works!&quot;;</code></pre><h2 id="proof-that-it-works-from-commonjs-in-node-✔">Proof that it works from CommonJS (in Node) ✔</h2>
<pre><code>const { test } = require(&quot;./test.js&quot;);
console.log(test);</code></pre><p>Output: <code>works!</code></p>
<h2 id="how-about-from-an-es-module-in-node-✔">How about from an ES module in Node? ✔</h2>
<pre><code>import { test } from &quot;./test.js&quot;;
console.log(test);</code></pre><p>Output: <code>works!</code></p>
<h2 id="how-about-from-an-es-module-in-a-web-page-✖">How about from an ES module in a web page? ✖</h2>
<pre><code>&lt;html&gt;
    &lt;body&gt;
        &lt;p&gt;Output: &lt;span id=&quot;result&quot;&gt;?&lt;/span&gt;&lt;/p&gt;
        &lt;script type=&quot;module&quot;&gt;
            import { test } from &quot;./test.js&quot;;

            document.getElementById(&quot;result&quot;).innerText = test;
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre><p>Doesn&#39;t work (error: &quot;The requested module &#39;./test.js&#39; does not provide an export named &#39;test&#39;&quot;).</p>
<h1 id="final-answer">Final answer</h1>
<p>You can use <code>import</code> to include a CommonJS module <em>when running in Node</em>, but <em>not</em> when running in a web page.</p>

</article>
        </main>
    </body>
</html>
