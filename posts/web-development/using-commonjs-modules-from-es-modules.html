<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Can you use CommonJS modules from within an ES module?</title>
<meta name="description" content="Is it possible to import a CommonJS module from within an ES module? Only in Node." />

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<link rel="stylesheet" href="../../css/style.css" />

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Can you use CommonJS modules from within an ES module?",
  "abstract": "Is it possible to import a CommonJS module from within an ES module? Only in Node.",
  "keywords": "web-development",
  "datePublished": "2021-09-29"
}
</script>
</head>
<body>
<header>
<h1><a href="../../index.html">Schemescape</a></h1>
<p>Development log of a life-long coder</p>

<nav>
<strong>Topics:&nbsp;</strong>
<ul>
<li><a href="../../posts/web-development/index.html">web-development</a></li>
</ul>
</nav>
</header>
<main>
<article>
<header>
<h1><a href="../../posts/web-development/using-commonjs-modules-from-es-modules.html">Can you use CommonJS modules from within an ES module?</a></h1>
<p><time datetime="2021-09-29">September 29, 2021</time></p>
</header>
<h1 id="question">Question</h1>
<p>Is it possible to import a CommonJS module from within an ES module (using <code>import</code> syntax)?</p>
<p>I thought a quick web search would answer this question, but instead most of the resources I found were about trying to <code>require()</code> ES modules (which you definitely can't do--use a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import#dynamic_imports">dynamic import</a> instead).</p>
<h1 id="background">Background</h1>
<p>JavaScript didn't originally have a module system, so various groups have created their own systems, e.g. <a href="http://www.commonjs.org/">CommonJS</a>, <a href="https://github.com/amdjs/amdjs-api">Asynchronous Module Definition (AMD)</a>, and the ironically named <a href="https://github.com/umdjs/umd">Universal Module Definition (UMD)</a>.</p>
<p>Predictably, there's now an official <a href="https://tc39.es/ecma262/#sec-modules">ECMAScript Modules</a> format that <del>everyone uses</del> <del>everyone should use</del> some people have started using (<del>because it's incompatible and they have no choice</del> because it's part of the official JavaScript/ECMAScript specification). And I won't even dig into the ES module file extension dumpster fire.</p>
<p>Anyway, back to the question: can I import a CommonJS module into my ES module?</p>
<h1 id="lets-just-try-it">Let's just try it...</h1>
<p>Here's a CommonJS module:</p>
<pre><code class="language-javascript"><span class="hl-identifier">exports</span><span class="hl-operator">.</span><span class="hl-identifier">test</span> <span class="hl-operator">=</span> <span class="hl-string">&quot;works!&quot;</span><span class="hl-operator">;</span>
</code></pre>
<h2 id="proof-that-it-works-from-commonjs-in-node-">Proof that it works from CommonJS (in Node) ✔</h2>
<pre><code class="language-javascript"><span class="hl-keyword">const</span> <span class="hl-operator">{</span> <span class="hl-identifier">test</span> <span class="hl-operator">}</span> <span class="hl-operator">=</span> <span class="hl-function">require</span><span class="hl-operator">(</span><span class="hl-string">&quot;./test.js&quot;</span><span class="hl-operator">)</span><span class="hl-operator">;</span>
<span class="hl-identifier">console</span><span class="hl-operator">.</span><span class="hl-function_method">log</span><span class="hl-operator">(</span><span class="hl-identifier">test</span><span class="hl-operator">)</span><span class="hl-operator">;</span>
</code></pre>
<p>Output: <code>works!</code></p>
<h2 id="how-about-from-an-es-module-in-node-">How about from an ES module in Node? ✔</h2>
<pre><code class="language-javascript"><span class="hl-keyword">import</span> <span class="hl-operator">{</span> <span class="hl-identifier">test</span> <span class="hl-operator">}</span> <span class="hl-identifier">from</span> <span class="hl-string">&quot;./test.js&quot;</span><span class="hl-operator">;</span>
<span class="hl-identifier">console</span><span class="hl-operator">.</span><span class="hl-function_method">log</span><span class="hl-operator">(</span><span class="hl-identifier">test</span><span class="hl-operator">)</span><span class="hl-operator">;</span>
</code></pre>
<p>Output: <code>works!</code></p>
<h2 id="how-about-from-an-es-module-in-a-web-page-">How about from an ES module in a web page? ✖</h2>
<pre><code class="language-html"><span class="hl-tag_chars">&lt;</span><span class="hl-tag">html</span><span class="hl-tag_chars">&gt;</span>
    <span class="hl-tag_chars">&lt;</span><span class="hl-tag">body</span><span class="hl-tag_chars">&gt;</span>
        <span class="hl-tag_chars">&lt;</span><span class="hl-tag">p</span><span class="hl-tag_chars">&gt;</span><span class="hl-default">O</span><span class="hl-default">u</span><span class="hl-default">t</span><span class="hl-default">p</span><span class="hl-default">u</span><span class="hl-default">t</span><span class="hl-default">:</span> <span class="hl-tag_chars">&lt;</span><span class="hl-tag">span</span> <span class="hl-attribute">id</span><span class="hl-operator">=</span><span class="hl-string">&quot;result&quot;</span><span class="hl-tag_chars">&gt;</span><span class="hl-default">?</span><span class="hl-tag_chars">&lt;/</span><span class="hl-tag">span</span><span class="hl-tag_chars">&gt;</span><span class="hl-tag_chars">&lt;/</span><span class="hl-tag">p</span><span class="hl-tag_chars">&gt;</span>
        <span class="hl-tag_chars">&lt;</span><span class="hl-tag">script</span> <span class="hl-attribute">type</span><span class="hl-operator">=</span><span class="hl-string">&quot;module&quot;</span><span class="hl-tag_chars">&gt;</span>
            <span class="hl-default">i</span><span class="hl-default">m</span><span class="hl-default">p</span><span class="hl-default">o</span><span class="hl-default">r</span><span class="hl-default">t</span> <span class="hl-default">{</span> <span class="hl-default">t</span><span class="hl-default">e</span><span class="hl-default">s</span><span class="hl-default">t</span> <span class="hl-default">}</span> <span class="hl-default">f</span><span class="hl-default">r</span><span class="hl-default">o</span><span class="hl-default">m</span> <span class="hl-default">&quot;</span><span class="hl-default">.</span><span class="hl-default">/</span><span class="hl-default">t</span><span class="hl-default">e</span><span class="hl-default">s</span><span class="hl-default">t</span><span class="hl-default">.</span><span class="hl-default">j</span><span class="hl-default">s</span><span class="hl-default">&quot;</span><span class="hl-default">;</span>
            
            <span class="hl-default">d</span><span class="hl-default">o</span><span class="hl-default">c</span><span class="hl-default">u</span><span class="hl-default">m</span><span class="hl-default">e</span><span class="hl-default">n</span><span class="hl-default">t</span><span class="hl-default">.</span><span class="hl-default">g</span><span class="hl-default">e</span><span class="hl-default">t</span><span class="hl-default">E</span><span class="hl-default">l</span><span class="hl-default">e</span><span class="hl-default">m</span><span class="hl-default">e</span><span class="hl-default">n</span><span class="hl-default">t</span><span class="hl-default">B</span><span class="hl-default">y</span><span class="hl-default">I</span><span class="hl-default">d</span><span class="hl-default">(</span><span class="hl-default">&quot;</span><span class="hl-default">r</span><span class="hl-default">e</span><span class="hl-default">s</span><span class="hl-default">u</span><span class="hl-default">l</span><span class="hl-default">t</span><span class="hl-default">&quot;</span><span class="hl-default">)</span><span class="hl-default">.</span><span class="hl-attribute_unknown">innerText</span> <span class="hl-operator">=</span> <span class="hl-default">t</span><span class="hl-default">e</span><span class="hl-default">s</span><span class="hl-default">t</span><span class="hl-default">;</span>
        <span class="hl-tag_chars">&lt;/</span><span class="hl-tag">script</span><span class="hl-tag_chars">&gt;</span>
    <span class="hl-tag_chars">&lt;/</span><span class="hl-tag">body</span><span class="hl-tag_chars">&gt;</span>
<span class="hl-tag_chars">&lt;/</span><span class="hl-tag">html</span><span class="hl-tag_chars">&gt;</span>
</code></pre>
<p>Doesn't work (error: &quot;The requested module './test.js' does not provide an export named 'test'&quot;).</p>
<h1 id="final-answer">Final answer</h1>
<p>You can use <code>import</code> to include a CommonJS module <em>when running in Node</em>, but <em>not</em> when running in a web page.</p>

<footer>
<p>&crarr; <a href="../../index.html">Back to home</a></p>
</footer>
</article>
</main>

</body>
</html>
